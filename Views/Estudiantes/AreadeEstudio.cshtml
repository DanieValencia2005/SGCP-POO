@model IEnumerable<SGCP_POO.Models.AreaEstudio>

@{
    ViewData["Title"] = "AreaEstudio";
}

<main class="container mt-4">
    <h1 class="mb-4">Área de Estudio</h1>

    @if (Model != null && Model.Any())

    {
        <!-- Agrupar por tarjeta -->
        var tarjetas = Model.GroupBy(t => t.NombreTarjeta);



        foreach (var tarjeta in tarjetas)

        {
            <section class="mb-5">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">@tarjeta.Key</h5>
                        <small class="text-muted">
                            Última vez usado: @tarjeta.Max(t => t.FechaUso).ToShortDateString()
                        </small>
                    </div>

                    <div class="card-body">
                        <h6 class="mb-3">Recursos guardados</h6>

                        @foreach (var area in tarjeta)

                        {

                            var recurso = area.Recurso;

                            if (recurso != null)

                            {
                                <div class="border rounded p-3 mb-3">
                                    <h6 class="fw-bold text-primary">@recurso.Titulo</h6>

                                    <p><strong>Descripción:</strong> @recurso.Descripcion</p>
                                    <p><strong>Palabras clave:</strong> @recurso.PalabrasClave</p>
                                    <p><strong>Tema:</strong> @recurso.Tema</p>
                                    <p><strong>Formato:</strong> @recurso.Formato</p>

                                    @if (!string.IsNullOrEmpty(recurso.Enlace))

                                    {
                                        <a href="@recurso.Enlace" target="_blank" class="btn btn-sm btn-outline-primary">Ver recurso</a>
                                    }

                                    else

                                    {
                                        <span class="text-muted">Sin enlace disponible</span>
                                    }
                                </div>
                            }

                        }
                    </div>
                </div>
            </section>
        }

    }

    else

    {
        <div class="alert alert-info mt-4" role="alert">
            No tienes recursos guardados aún.
        </div>
    }
</main>
